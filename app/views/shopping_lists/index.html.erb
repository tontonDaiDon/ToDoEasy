<!-- app/views/shopping_lists/index.html.erb -->

<body class="shopping-lists-index">

  <p style="color: green"><%= notice %></p>

  <h1 class="shopping-lists-header">買い物リスト一覧</h1>

  <%= link_to '新しいリストを作成', new_shopping_list_path, class: "btn btn-edit" %>

  <%= form_with url: shopping_lists_path, method: :get, local: true, html: { class: "shopping-lists-form" } do %>
    <%= month_field_tag :year_month, params[:year_month] %>
    <%= submit_tag "検索" %>
  <% end %>

  <% if params[:year_month].present? %>
    <h3><%= params[:year_month] %>の予算合計：<%= @monthly_budget_total %>円</h3>
  <% end %>

  <!-- 既存の繰り返し処理の中で -->
<% @shopping_lists.each do |list| %>
  <div class="card mb-3 shadow-sm">
    <div class="card-body">
    <h5 class="card-title">
    <%= link_to list.name, before_shopping_shopping_list_path(list) %>
    </h5>
    <p class="card-text">予算：<%= number_to_currency(list.budget, unit: "¥", precision: 0) %></p>
      <div class="d-flex justify-content-end">
        <%= link_to "編集", edit_shopping_list_path(list), class: "btn btn-edit" %>
        <%= link_to "削除", shopping_list_path(list),
                    method: :delete,
                    data: { confirm: "本当に削除しますか？" },
                    class: "btn btn-delete" %>
      </div>
    </div>
  </div>
<% end %>
</body>